import{G as y,r as _,g as D,o as r,c as l,d as e,t as s,F as v,h as p,V as w,W as C}from"./index-9511e055.js";import{e as k,h as S,i as Y}from"./materials-40f5ef17.js";import{searchMindmapsByTags as b}from"./tagBasedMindmap-6b59b98e.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./storage-02b3d0a9.js";import"./mindmap-a70de1df.js";function T(d,o="YYYY-MM-DD HH:mm:ss"){if(!d)return"";const n=new Date(d);if(isNaN(n.getTime()))return console.error("Invalid date:",d),"";const t=n.getFullYear(),c=String(n.getMonth()+1).padStart(2,"0"),m=String(n.getDate()).padStart(2,"0"),a=String(n.getHours()).padStart(2,"0"),u=String(n.getMinutes()).padStart(2,"0"),h=String(n.getSeconds()).padStart(2,"0");return o.replace("YYYY",t).replace("MM",c).replace("DD",m).replace("HH",a).replace("mm",u).replace("ss",h)}const x={setup(){const o=y().params.id,n=_({}),t=_([]),c=_(""),m=_(!0),a=_([]),u=async()=>{try{const[i,f]=await Promise.all([k(o),S(o)]);if(n.value=i.data,t.value=f.data,n.value.hierarchicalTags){const M=await b(n.value.hierarchicalTags);a.value=M}}catch(i){console.error("获取数据失败:",i)}finally{m.value=!1}},h=async()=>{if(c.value.trim())try{const i=await Y(o,{content:c.value});t.value.unshift(i.data),c.value=""}catch(i){console.error("提交评论失败:",i)}},g=i=>{window.open(`/mindmap/${i}`,"_blank")};return D(()=>{u()}),{material:n,comments:t,newComment:c,loading:m,relatedMindmaps:a,formatDate:T,submitComment:h,viewMindmap:g}}},B={class:"material-detail"},A={key:0,class:"loading"},F={key:1},I={class:"material-info"},L={class:"meta"},N=["innerHTML"],R={class:"mindmaps-section"},V={key:0,class:"mindmaps-list"},E={class:"mindmap-meta"},G=["onClick"],P={key:1,class:"no-mindmaps"},U={class:"comments-section"},W={class:"comment-form"},j=["disabled"],q={class:"comments-list"},z={class:"comment-header"},J={class:"username"},K={class:"time"},O={class:"comment-content"};function Q(d,o,n,t,c,m){return r(),l("div",B,[t.loading?(r(),l("div",A,"加载中...")):(r(),l("div",F,[e("div",I,[e("h1",null,s(t.material.title),1),e("div",L,[e("span",null,"作者："+s(t.material.author),1),e("span",null,"发布时间："+s(t.formatDate(t.material.createdAt)),1)]),e("div",{class:"content",innerHTML:t.material.content},null,8,N)]),e("div",R,[e("h2",null,"相关思维导图（"+s(t.relatedMindmaps.length)+"）",1),t.relatedMindmaps.length>0?(r(),l("div",V,[(r(!0),l(v,null,p(t.relatedMindmaps,a=>(r(),l("div",{key:a.id,class:"mindmap-item"},[e("h3",null,s(a.title),1),e("p",null,s(a.description),1),e("div",E,[e("span",null,"节点数："+s(a.nodeCount),1),e("span",null,"创建时间："+s(t.formatDate(a.createdAt)),1)]),e("button",{onClick:u=>t.viewMindmap(a.id)},"查看",8,G)]))),128))])):(r(),l("div",P," 暂无相关思维导图 "))]),e("div",U,[e("h2",null,"评论（"+s(t.comments.length)+"）",1),e("div",W,[w(e("textarea",{"onUpdate:modelValue":o[0]||(o[0]=a=>t.newComment=a),placeholder:"请输入评论内容"},null,512),[[C,t.newComment]]),e("button",{onClick:o[1]||(o[1]=(...a)=>t.submitComment&&t.submitComment(...a)),disabled:!t.newComment.trim()},"提交评论",8,j)]),e("div",q,[(r(!0),l(v,null,p(t.comments,a=>(r(),l("div",{key:a.id,class:"comment-item"},[e("div",z,[e("span",J,s(a.user.name),1),e("span",K,s(t.formatDate(a.createdAt)),1)]),e("div",O,s(a.content),1)]))),128))])])]))])}const nt=H(x,[["render",Q],["__scopeId","data-v-7a305484"]]);export{nt as default};
