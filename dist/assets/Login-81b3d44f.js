import{u as q,r as b,a as S,b as _,o as v,c as w,d as m,e as r,w as o,f as d,E as p}from"./index-9511e055.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";const L={class:"login-container"},D={class:"login-box"},T={class:"login-header"},h={key:0},B={key:1},M={key:0,class:"login-form"},A={class:"login-options"},j={class:"form-footer"},z={key:1,class:"register-form"},G={class:"form-footer"},H={__name:"Login",setup(K){const I=q(),y=b(null),x=b(null),i=b(!1),g=b(!0),a=S({username:"",password:"",remember:!1}),s=S({username:"",email:"",password:"",confirmPassword:""}),R={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3到20个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度应在6到20个字符之间",trigger:"blur"}]},N={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3到20个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度应在6到20个字符之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(u,e,l)=>{e===""?l(new Error("请再次输入密码")):e!==s.password?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}]},C=()=>{const u=localStorage.getItem("users");if(u)try{return JSON.parse(u)}catch(e){return console.error("解析用户数据失败",e),V}else return localStorage.setItem("users",JSON.stringify(V)),V},V=[{username:"admin",password:"123456",role:"管理员",avatar:"A",email:"admin@example.com",registerDate:"2023-01-01",bio:"系统管理员账户，负责管理系统各项功能和用户。"},{username:"user",password:"123456",role:"普通用户",avatar:"U",email:"user@example.com",registerDate:"2023-02-15",bio:"普通用户账户"}],f=b(C()),P=()=>{y.value&&y.value.validate(u=>{u&&(i.value=!0,setTimeout(()=>{const e=f.value.find(l=>l.username===a.username&&l.password===a.password);e?(localStorage.setItem("currentUser",JSON.stringify(e)),localStorage.setItem("isLoggedIn","true"),a.remember?localStorage.setItem("rememberUser",JSON.stringify({username:a.username,remember:!0})):localStorage.removeItem("rememberUser"),p({message:"登录成功",type:"success"}),I.push("/dashboard")):p.error("用户名或密码错误"),i.value=!1},1e3))})},E=()=>{x.value&&x.value.validate(u=>{if(u){i.value=!0;const e=f.value.some(t=>t.username===s.username),l=f.value.some(t=>t.email===s.email);if(e){p.error("用户名已存在"),i.value=!1;return}if(l){p.error("邮箱已被注册"),i.value=!1;return}setTimeout(()=>{const t={username:s.username,password:s.password,email:s.email,role:"普通用户",avatar:s.username.charAt(0).toUpperCase(),registerDate:new Date().toISOString().split("T")[0],bio:""};f.value.push(t),localStorage.setItem("users",JSON.stringify(f.value)),p({message:"注册成功，请登录",type:"success"}),g.value=!0,i.value=!1},1e3)}})},F=()=>{p({message:"请联系系统管理员重置密码",type:"info"})},U=()=>{g.value=!g.value};return(()=>{const u=localStorage.getItem("rememberUser");if(u)try{const e=JSON.parse(u);a.username=e.username,a.remember=e.remember}catch(e){console.error("解析记住的用户数据失败",e)}})(),(u,e)=>{const l=_("el-input"),t=_("el-form-item"),O=_("el-checkbox"),c=_("el-button"),k=_("el-form");return v(),w("div",L,[m("div",D,[m("div",T,[e[7]||(e[7]=m("h1",null,"思维导图系统",-1)),g.value?(v(),w("p",h,"登录您的账户以继续")):(v(),w("p",B,"创建新账户"))]),g.value?(v(),w("div",M,[r(k,{model:a,rules:R,ref_key:"loginFormRef",ref:y,"label-position":"top"},{default:o(()=>[r(t,{label:"用户名",prop:"username"},{default:o(()=>[r(l,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=n=>a.username=n),placeholder:"请输入用户名","prefix-icon":"el-icon-user"},null,8,["modelValue"])]),_:1}),r(t,{label:"密码",prop:"password"},{default:o(()=>[r(l,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=n=>a.password=n),type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock","show-password":""},null,8,["modelValue"])]),_:1}),m("div",A,[r(O,{modelValue:a.remember,"onUpdate:modelValue":e[2]||(e[2]=n=>a.remember=n)},{default:o(()=>e[8]||(e[8]=[d("记住我")])),_:1},8,["modelValue"]),r(c,{type:"text",onClick:F},{default:o(()=>e[9]||(e[9]=[d("忘记密码？")])),_:1})]),r(t,null,{default:o(()=>[r(c,{type:"primary",class:"login-button",onClick:P,loading:i.value},{default:o(()=>e[10]||(e[10]=[d("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),m("div",j,[m("p",null,[e[12]||(e[12]=d("还没有账户？ ")),r(c,{type:"text",onClick:U},{default:o(()=>e[11]||(e[11]=[d("立即注册")])),_:1})])])])):(v(),w("div",z,[r(k,{model:s,rules:N,ref_key:"registerFormRef",ref:x,"label-position":"top"},{default:o(()=>[r(t,{label:"用户名",prop:"username"},{default:o(()=>[r(l,{modelValue:s.username,"onUpdate:modelValue":e[3]||(e[3]=n=>s.username=n),placeholder:"请输入用户名","prefix-icon":"el-icon-user"},null,8,["modelValue"])]),_:1}),r(t,{label:"邮箱",prop:"email"},{default:o(()=>[r(l,{modelValue:s.email,"onUpdate:modelValue":e[4]||(e[4]=n=>s.email=n),placeholder:"请输入邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),r(t,{label:"密码",prop:"password"},{default:o(()=>[r(l,{modelValue:s.password,"onUpdate:modelValue":e[5]||(e[5]=n=>s.password=n),type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock","show-password":""},null,8,["modelValue"])]),_:1}),r(t,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[r(l,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[6]||(e[6]=n=>s.confirmPassword=n),type:"password",placeholder:"请再次输入密码","prefix-icon":"el-icon-lock","show-password":""},null,8,["modelValue"])]),_:1}),r(t,null,{default:o(()=>[r(c,{type:"primary",class:"login-button",onClick:E,loading:i.value},{default:o(()=>e[13]||(e[13]=[d("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),m("div",G,[m("p",null,[e[15]||(e[15]=d("已有账户？ ")),r(c,{type:"text",onClick:U},{default:o(()=>e[14]||(e[14]=[d("返回登录")])),_:1})])])]))])])}}},Z=J(H,[["__scopeId","data-v-18b9ffc6"]]);export{Z as default};
